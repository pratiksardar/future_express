# Phase 1: The Autonomous Economy - Demo Guide

This document outlines the exact implementations and demo steps for the Phase 1 bounties targeting **Base** and **Uniswap**.

## 1. Base: Self-Sustaining Autonomous Agents ($10,000 Bounty)

**The Pitch:** 
The core "Editor Agent" of Future Express operates via a Base wallet. It can only generate the daily news if it possesses sufficient ETH to pay for its own LLM operations. If the wallet depletes below 0.001 ETH, the autonomous system halts and refuses to publish, perfectly demonstrating verifiable self-sustenance.

### ðŸ’» Code Implementation

**1. The Balancer Checker (`src/lib/base/editorWallet.ts`)**
This module dynamically queries the RPC to verify the agent's live Base balance.
```typescript
// lines 25-51
export async function checkEditorWalletBalance(): Promise<EditorWalletCheck | null> {
  const address = process.env.EDITOR_WALLET_ADDRESS;
  if (!address) return null;
  // ...
  const provider = new ethers.JsonRpcProvider(rpc);
  const balanceWei = await provider.getBalance(address);
  const ok = balanceWei >= minRequiredWei;
  return { ok, address, balanceWei, minRequiredWei, /*...*/ };
}
```

**2. The System Kill-Switch (`src/app/api/cron/edition/route.ts`)**
The central pipeline explicitly shuts down execution and throws a `503 Service Unavailable` if the agent runs out of funding.
```typescript
// lines 22-37
const walletCheck = await checkEditorWalletBalance();
if (walletCheck && !walletCheck.ok) {
  return NextResponse.json(
    {
      error: "Editor wallet insufficient balance",
      editorWallet: {
        address: walletCheck.address,
        balanceWei: walletCheck.balanceWei.toString(),
        minRequiredWei: walletCheck.minRequiredWei.toString(),
        message: walletCheck.message,
      },
      hint: "Set EDITOR_WALLET_ADDRESS and fund it on Base, or unset to skip balance check.",
    },
    { status: 503 }
  );
}
```

### ðŸŽ¯ How to Demo Live
1. Open your `.env` file.
2. Change the `EDITOR_WALLET_ADDRESS` to a random, unfunded wallet (e.g., `0x0000000000000000000000000000000000000001`).
3. Using an API client (like Postman or cURL), trigger the cron: `POST http://localhost:3000/api/cron/edition`
4. **Result:** The system will proudly reject the request with `503 Service Unavailable` and display the "Editor wallet insufficient balance" message, proving the agent cannot be forced to work without pay.
5. Restore the funded wallet address in `.env` to fix it!

---

## 2. Uniswap Foundation: Integrate Uniswap API ($5,000 Bounty)

**The Pitch:**
Prediction markets are meaningless if readers can't action the "Betting Advice" generated by the AI. By embedding the Uniswap Trading API natively at the bottom of every article, readers can instantly route native ETH to USDC with zero slippage perfectly inside the newsroom context.

### ðŸ’» Code Implementation

**1. The Trading Route Proxy (`src/app/api/uniswap/quote/route.ts` & `swap/route.ts`)**
Securely abstracts the API keys and formats requests to Uniswap's `v1/quote` and `v1/swap` gateways.
```typescript
// src/app/api/uniswap/quote/route.ts (lines 34-45)
quote = await getQuote({
  tokenIn,
  tokenOut,
  tokenInChainId: config.chainId,
  tokenOutChainId: config.chainId,
  amount,
  swapper,
  type: "EXACT_INPUT",
  ...(slippageTolerance != null && { slippageTolerance }),
});
```

**2. The Swap Widget (`src/components/UniswapSwapWidget.tsx`)**
The frontend component handles MetaMask injection, queries the proprietary routing paths dynamically, and natively wraps the `tx.value` array into Ethereum execution.
```typescript
// lines 105-155
const executeSwap = useCallback(async () => {
    // ...
    const swapRes = await fetch("/api/uniswap/swap", {
      method: "POST",
      body: JSON.stringify({ quote: quote.quote /* ... */ }),
    });
    const swapData = await swapRes.json();
    const txReq = {
      to: tx.to,
      value: tx.value ? BigInt(tx.value) : BigInt(0),
      data: tx.data,
      gasLimit: tx.gas ? BigInt(tx.gas) : undefined,
    };
    const sent = await signer.sendTransaction(txReq);
    // ...
});
```

### ðŸŽ¯ How to Demo Live
1. Run the local development server (`npm run dev`).
2. Open `http://localhost:3000/` in your browser.
3. Click on any article on the front page.
4. Scroll to the bottom of the article body to find the **Swap ETH â†’ USDC** block.
5. Connect your wallet and ensure you are on **Ethereum Sepolia**.
6. Enter an amount (like `0.001`), click **Get quote**.
7. Click **Swap**!
8. **Result:** A seamless, single-click MetaMask transaction will appear. Confirming it executes a native ETH to USDC route powered directly by the Uniswap Advanced Trading API via the Universal Router.
